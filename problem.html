<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problem Formulation | ACIA Framework</title>
    <style>
        body { font-family: 'Inter', sans-serif; margin: 0; padding: 0; background-color: #f7f7f7; color: #333; line-height: 1.6; }
        .page-container { max-width: 900px; margin: 50px auto; padding: 40px; background: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h2 { font-size: 2em; color: #1a73e8; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 20px; }
        h3 { font-size: 1.5em; color: #333; margin-top: 30px; margin-bottom: 15px; }
        p { margin-bottom: 1.5em; font-size: 1.1em; text-align: justify; }
        ul, ol { margin-bottom: 1.5em; padding-left: 25px; font-size: 1.1em; }
        .assumption-box { margin-bottom: 1.5em; padding: 15px; border-left: 5px solid #ff9800; background-color: #fff8e1; border-radius: 4px; }
        .assumption-box strong { display: block; margin-bottom: 8px; font-size: 1.1em; color: #e65100; }
        .goal-box { margin-bottom: 1.5em; padding: 15px; border-left: 5px solid #4caf50; background-color: #f1f8f4; border-radius: 4px; }
        .goal-box strong { display: block; margin-bottom: 8px; font-size: 1.1em; color: #2e7d32; }
        .footnote { font-size: 0.95em; color: #666; padding: 10px; background-color: #f9f9f9; border-left: 3px solid #ccc; margin: 15px 0; }
    </style>
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="page-container">
        <p><a href="index.html">‚Üê Back to Main Page</a></p>

        <h2>Theoretical Framework</h2>

        <p>This section presents our theoretical framework ACIA for anti-causal representation learning. Our theoretical analysis relies on the following assumptions:</p>

        <div class="assumption-box">
            <strong>Assumptions</strong>
            <ul>
                <li>The number of training environments $|\mathcal{E}_{\text{train}}| = K < \infty$.</li>
                <li>For any spurious feature $s$ correlated with $Y$ in $e_i$, there exists $e_j \in \mathcal{E}_{\text{train}}$ where $s \perp\!\!\!\perp Y$.</li>
                <li>We have access to samples from interventional distributions $P(X | do(Y=y))$ via intervention $\mathbb{Q}$.</li>
                <li>Representations are $L$-Lipschitz continuous with respect to appropriate metrics.</li>
            </ul>
        </div>

        <h3>Problem Formulation</h3>

        <p>We formalize the anti-causal representation learning problem as follows: given a causal structure where label $Y$ causes the observation $X$ and environment $E$ also influences $X$ ($Y \rightarrow X \leftarrow E$), our goal is to learn representations that capture the causal generative invariant from $Y$ to $X$.</p>

        <div class="footnote">
            <strong>Note:</strong> A <em>causal generative invariant</em> is a stable function $f: \mathcal{Y} \rightarrow \mathcal{X}$ by which $Y$ produces $X$, formally represented as $X = f(Y, \epsilon)$ where $\epsilon$ represents noise, and $f$ is invariant across environments.
        </div>

        <div class="goal-box">
            <strong>Learning Goal</strong>
            <p>Given observations from environments $\mathcal{E} = \{e_i\}_{i=1}^n$ with corresponding datasets $\mathcal{D} = \{D_{e_i}\}_{i=1}^n$, we aim to learn two-level representations:</p>
            <ul>
                <li><strong>Low-level representation</strong> $\phi_L: \mathcal{D} \subset \mathcal{X} \rightarrow \mathcal{Z}_L$ that extracts features from raw data to uncover the anti-causal structure including both $Y \rightarrow X$ and $E \rightarrow X$.</li>
                <li><strong>High-level representation</strong> $\phi_H: \mathcal{Z}_L \rightarrow \mathcal{Z}_H$ that distills environment-invariant causal features from $\phi_L$, i.e., enforcing $\phi_H(\phi_L(X)) \perp E \mid Y$.</li>
            </ul>
        </div>

        <p>The predictor $\mathcal{C}: \mathcal{Z}_H \rightarrow \mathcal{Y}$ then maps high-level representations to labels. With a loss function $\ell: \mathcal{Y} \times \mathcal{Y} \rightarrow \mathbb{R}_+$ defined across all environments $\mathcal{E}$, the full model $f = \mathcal{C} \circ \phi_H \circ \phi_L$ can be trained in an end-to-end fashion.</p>

        <h3>Learning the Two-Level Representations</h3>

        <p>More specifically, we introduce <strong>causal dynamics</strong> (Theorem 3) to facilitate learning low-level representations $\mathcal{Z}_L$ by jointly optimizing the loss with a causal structure consistency regularizer ($R_2$), where minimizing it encourages the low-level representations to align with the true causal mechanisms underlying the data.</p>

        <p>On top of $\mathcal{Z}_L$, we further introduce <strong>causal abstraction</strong> (Theorem 4) to learn high-level representations, guided by another environment independence regularizer ($R_1$). This regularizer measures the discrepancy between the expected high-level representations across environments conditioned on the label $Y$. Minimizing it can remove environment-specific information while retaining label-relevant causal features.</p>

        <h3>Two-Level Design Rationale</h3>

        <p>This hierarchical structure enables us to do two procedures:</p>
        <ol>
            <li><strong>Interventional effect calculation:</strong> $\phi_L$ captures how the anti-causal setting responds to interventions, handling both perfect and imperfect intervention scenarios.</li>
            <li><strong>Information bottleneck:</strong> $\phi_H$ retains only label-relevant invariants while discarding environment-specific noise.</li>
        </ol>

    </div>
</body>
</html>